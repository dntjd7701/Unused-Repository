**![[Pasted image 20231018090342.png]]


#### 화면 주요 기능 

- CRUD
- 두 개의 부모-자식 관계를 가진 그리드를 가진다.
- 인쇄 기능(DRF 제작)
- BATCH BOM복사: 모품목-자품목 관계에 대한 데이터를 옵션에 따라 다른 모품목을 기준으로 복사한다. 
- 일괄자재변경: 자품목에 대한 정보를 일괄적으로 변경한다. 이 때, 품목 자체 변경도 가능하다.


#### 개발 특이 사항

- 트리 구조의 그리드와 일반 그리드의 CRUD 화면
- 모품목-자품목 간의 재귀 구조로 쿼리를 작성하였으며(with recursive), 이 때 순환참조 에러를 검증하는 부분에 관심을 기울였다.  [[ 순환 참조 쿼리 참고]]
- 무한 참조를 방지하기 위해 설계팀과의 협의 후 최대 20level로  제한을 두었다. 
- 각 수량값의 경우 수량 포맷에 맞추었으며, 이 때 필요수량의 계산값은 아래와 같다
$$
필요수량 = 정미수량 + (정미수량 * 로스율) / 100;
$$



#### 문제 사항 

> 트리그리드의 'useCustomLayout'
> - 요구사항 : 트리 그리드에서 '사급구분' 컬럼의 '컬럼 숨기기/표시' 기능 활성화 
> - 문제 : DataGridInterface 중 treeView 타입일 경우, useCustomLayout의 기능 활성화 시, 본 화면은 마스터-디테일의 관계로 디테일 그리드가 자동 조회됨으로 수정 중인 데이터가 있다고 판단되어 '컬럼표시' 기능이 제한된다.
> ![[Pasted image 20231018092149.png]]
> 
> - 문제 분석 : OBTDataGridInterface의 경우 현재 수정 권한이 없는 공통 컴포넌트로, imageLabel이란 속성의 기능에 문제가 있어 이를 해결하기 위해 우회하여 처리한 코드가 존재했다. 이 과정에서 그리드의 상태가 '수정' 상태로 전환되어 위의 문제가 발생한 것으로 확인됐다. 
> - 해결 : 테스트 확인 결과, 이전에 요청한 공통 컴포넌트의 기능이 수정되어 우회를 위해 작성한 코드가 더이상 필요하지 않게 되었다. 이를 제거함으로 위의 문제 또한 연쇄적으로 해결되었다. 


**