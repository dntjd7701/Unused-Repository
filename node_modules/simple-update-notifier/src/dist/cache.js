"use strict";
exports.__esModule = true;
exports.saveLastUpdate = exports.getLastUpdate = exports.createConfigDir = void 0;
var os_1 = require("os");
var path_1 = require("path");
var fs_1 = require("fs");
var homeDirectory = os_1["default"].homedir();
var configDir = process.env.XDG_CONFIG_HOME ||
    path_1["default"].join(homeDirectory, '.config', 'simple-update-notifier');
var getConfigFile = function (packageName) {
    return path_1["default"].join(configDir, packageName.replace('@', '').replace('/', '__') + ".json");
};
exports.createConfigDir = function () {
    if (!fs_1["default"].existsSync(configDir)) {
        fs_1["default"].mkdirSync(configDir, { recursive: true });
    }
};
exports.getLastUpdate = function (packageName) {
    var configFile = getConfigFile(packageName);
    try {
        if (!fs_1["default"].existsSync(configFile)) {
            return undefined;
        }
        var file = JSON.parse(fs_1["default"].readFileSync(configFile, 'utf8'));
        return file.lastUpdateCheck;
    }
    catch (_a) {
        return undefined;
    }
};
exports.saveLastUpdate = function (packageName) {
    var configFile = getConfigFile(packageName);
    fs_1["default"].writeFileSync(configFile, JSON.stringify({ lastUpdateCheck: new Date().getTime() }));
};
